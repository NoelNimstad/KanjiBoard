!function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var n=t();for(var o in n)("object"==typeof exports?exports:e)[o]=n[o]}}(this,()=>(()=>{"use strict";var e={d:(t,n)=>{for(var o in n)e.o(n,o)&&!e.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:n[o]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};function n(e,t){if(null==e)throw new Error(t??"Value failed non-null assertion!");return e}function o(e,t){if(!e)throw new Error(t??"Condition false!")}e.r(t),e.d(t,{SCALE:()=>l,context:()=>d,kb:()=>x});const r=2*Math.PI;function s(e){d.fillStyle="red";for(let t=0;t<e.length;t++)d.beginPath(),d.arc(e[t][0],e[t][1],3,0,r),d.fill()}function i(e){let t=[],n=e,o=[];for(let e=0;e<n.length;e++)switch(n[e][0]){case"m":{let r=n[e].substring(1).split(",");o[0]=parseFloat(r[0]),o[1]=parseFloat(r[1]),t.push([o[0]*l,o[1]*l])}break;case"M":{let r=n[e].substring(1).split(",");o[0]=parseFloat(r[0]),o[1]=parseFloat(r[1]),t.push([o[0]*l,o[1]*l])}break;case"c":{let r=n[e].substring(1).split(",");for(;r.length>2;)r.shift();let s=parseFloat(r[0]),i=parseFloat(r[1]);o[0]+=s,o[1]+=i,t.push([o[0]*l,o[1]*l])}break;case"C":{let r=n[e].substring(1).split(",");for(;r.length>2;)r.shift();o[0]=parseFloat(r[0]),o[1]=parseFloat(r[1]),t.push([o[0]*l,o[1]*l])}break;default:console.log("you messed up")}return t}const l=3,a=9*l;let c,u,d,p=!1,g={x:0,y:0},h={x:0,y:0},y={x:0,y:0},v={kanji:"木",strokeCount:0,strokes:new Array(new Array(new Array)),currentStroke:0,currentPoint:0,svgPaths:new Array},f={x:0,y:0};const k=()=>{let e=c.getBoundingClientRect();f.x=e.x,f.y=e.y},w=e=>({x:e.x-f.x,y:e.y-f.y});let b=()=>{};const m=new ResizeObserver(e=>{for(const t of e)if(t.target===c||t.target===c.parentElement){k();break}});window.addEventListener("scroll",k,{passive:!0});const x={initialise:async function(e){const t=document.createElement("div");t.style.position="relative",t.style.width=(109*l).toString(),t.style.height=(109*l).toString(),e.append(t);const o=document.createElementNS("http://www.w3.org/2000/svg","svg");o.setAttribute("xmlns","http://www.w3.org/2000/svg"),o.setAttribute("width",(109*l).toString()),o.setAttribute("height",(109*l).toString()),o.setAttributeNS(null,"viewBox","0 0 109 109"),o.style.position="absolute",o.style.backgroundImage="url(../../public/box.svg)",o.style.backgroundSize="cover",o.style.pointerEvents="none",o.style.boxSizing="border-box",o.style.zIndex="-1";const r=document.createElementNS("http://www.w3.org/2000/svg","g");r.style="fill:none;stroke:#000000;stroke-width:3;stroke-linecap:round;stroke-linejoin:round;",u=document.createElementNS("http://www.w3.org/2000/svg","g"),u.setAttribute("kvg:element","木"),u.setAttribute("kvg:radical","general"),c=document.createElement("canvas"),c.width=109*l,c.height=109*l,t.append(c),c.style.imageRendering="cris-edges",c.style.position="absolute",c.style.zIndex="1",c.style.touchAction="none",r.append(u),o.append(r),t.append(o),d=n(c.getContext("2d")),d.strokeStyle="black",d.lineWidth=2.5*l,d.lineCap="round",c.addEventListener("mousedown",e=>{if(p||v.currentStroke>=v.strokeCount)return;const t=w(e);g.x=y.x=h.x=t.x,g.y=y.y=h.y=t.y,p=!0,v.currentPoint=0,console.clear(),console.debug("Started drawing")}),c.addEventListener("mouseup",()=>{p&&(p=!1,d.clearRect(0,0,c.width,c.height),s(v.strokes[v.currentStroke]),console.debug("Stopped drawing"))}),c.addEventListener("mousemove",e=>{if(p){if(g.x=g.x+1*(y.x-g.x),g.y=g.y+1*(y.y-g.y),h=w(e),Math.abs(h.x-v.strokes[v.currentStroke][v.currentPoint][0])<=a&&Math.abs(h.y-v.strokes[v.currentStroke][v.currentPoint][1])<=a&&(console.log(`Point ${v.currentPoint++} cleared!`),v.currentPoint===v.strokes[v.currentStroke].length))return console.log(`Stroke ${v.currentStroke} cleared!`),u.innerHTML+=v.svgPaths[v.currentStroke++],p=!1,d.clearRect(0,0,c.width,c.height),void(v.currentStroke===v.strokeCount&&b());y.x=y.x+1*(h.x-y.x),y.y=y.y+1*(h.y-y.y),d.strokeStyle="black",d.beginPath(),d.moveTo(g.x,g.y),d.lineTo(y.x,y.y),d.stroke()}}),c.addEventListener("touchstart",e=>{let t=e.touches[0];if(void 0===t){let e=new MouseEvent("mousedown",{clientX:h.x,clientY:h.y});return void c.dispatchEvent(e)}let n=new MouseEvent("mousedown",{clientX:t.clientX,clientY:t.clientY});c.dispatchEvent(n)}),c.addEventListener("touchmove",e=>{let t=e.touches[0];if(void 0===t){let e=new MouseEvent("mousemove",{clientX:h.x,clientY:h.y});return void c.dispatchEvent(e)}let n=new MouseEvent("mousemove",{clientX:t.clientX,clientY:t.clientY});c.dispatchEvent(n)}),c.addEventListener("touchend",e=>{let t=e.touches[0];if(void 0===t){let e=new MouseEvent("mouseup",{clientX:h.x,clientY:h.y});return void c.dispatchEvent(e)}let n=new MouseEvent("mouseup",{clientX:t.clientX,clientY:t.clientY});c.dispatchEvent(n)}),m.observe(c),c.parentElement&&m.observe(c.parentElement),k()},load:async function(e){v.kanji=e,v.currentPoint=v.currentStroke=0;const t=await async function(e){o(1===e.length,"More than 1 character supplied!");const t=await fetch(`https://kanjivg.tagaini.net/kanjivg/kanji/${e.charCodeAt(0).toString(16).padStart(5,"0")}.svg`);return function(e,t){const r=n(e.match(/(<path(.*))/g));let s=[];for(let e of r){let t=[];const r=n(e.replace(/(.*)[Mm](.*?),(.*?)c(.*)/g,"$2:$3").split(":"));o(r.length>=2,"Insufficient data points!"),t.push([parseFloat(r[0]),parseFloat(r[1])]);let l=e.replace(/(.*)d="(.*)"(.*)/,"$2").replace(/(?<!,)-/g,",-").replace(/([mMcC])/g,":$1").split(":");l.shift(),s.push(i(l))}return{kanji:t,strokeCount:s.length,strokes:s,svgPaths:r}}(await t.text(),e)}(v.kanji);v.strokes=n(t.strokes,"No strokes found!"),o(v.strokes.length>0,"No strokes found!"),v.strokeCount=t.strokeCount,v.svgPaths=t.svgPaths,u.innerHTML="",d.clearRect(0,0,c.width,c.height),s(v.strokes[v.currentStroke])},setOnComplete:function(e){b=e}};return window.kb=x,t})());